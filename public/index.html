<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <meta charset="utf-8">
    <title>Крестики-нолики</title>
    <link rel="stylesheet" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.16/themes/smoothness/jquery-ui.css">
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.16/jquery-ui.min.js"></script>
    <script type="text/javascript" charset="utf-8" src="/lib/socket.io/socket.io.min.js"></script>
    <script src="tictactoe.js"></script>

    <style type="text/css">
        #board {
            height: 300px;
            width: 300px;
            display: none;
        }
        td {
            height: 100px;
            width: 100px;
            text-align: center;
            vertical-align: middle;
            font-size: 42pt;
            font-weight: bold;
            font-family: Arial;
        }
        #play_again {
            display: block;
            font-size: 20px;
        }
        #status {
            padding: 10px;
            margin: 10px;
        }
    </style>
    <script type="text/javascript">
        // Подключаемся к серверу nodejs с socket.io
        var socket = io.connect('http://95.31.245.10:80', {resource: 'api'});
        // Подключились
        socket.on('connect', function () {
            $('#status').html('Успешно подключились к игровому серверу');
        });
        // Переподключаемся
        socket.on('reconnect', function () {
            $('#connect-status').html('Переподключились, продолжайте игру');
        });
        // Соединение потеряно
        socket.on('reconnecting', function () {
            $('#status').html('Соединение с сервером потеряно, переподключаемся...');
        });
        // Ошибка
        socket.on('error', function (e) {
            $('#status').html('Ошибка: ' + (e ? e : 'неизвестная ошибка'));
        });
        // Ожидаем соперника
        socket.on('wait', function(){
            $('#status').append('... Ожидаем соперника...');
        });
        // Соперник отлючился
        socket.on('exit', function(){
            $('#status').append('Соперник сбежал с поля боя! Игра закончена.');
            TicTacToe.endGame(TicTacToe.turn, true);
        });
        // К нам подключился соперник, начинаем игру
        socket.on('ready', function(gameId, turn){
            $('#status').html('К вам подключился соперник! Игра началась! Вы ходите ' + (turn == 'X' ? 'X - первый' : 'O - второй') + '!');
            TicTacToe.startGame(gameId, turn);
            $("#board td").click(function (e) {
                if(TicTacToe.i) socket.emit('step', TicTacToe.gameId, e.target.id);
            });
        });
        // Получаем ход
        socket.on('step', function(id, turn, win) {
            console.info('step', id, turn, win);
            TicTacToe.move(id, turn, win);
        });

    </script>
</head>
<body>
    <div id="status" class="ui-widget ui-state-hover ui-corner-all">Подключаемся к серверу...</div>
    <div id="menu" class="ui-widget"></div>
    <div id="board" class="ui-widget"></div>
</body>
</html>